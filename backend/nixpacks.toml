[phases.setup]
nixPkgs = ["nodejs_20", "openssl", "openssl.dev"]

[phases.install]
cmds = ["yarn install --frozen-lockfile"]

[phases.build]
cmds = ["npx prisma generate", "yarn build"]

[start]
cmd = "echo 'ðŸ”§ Creating prisma directory...' && mkdir -p prisma && echo 'ðŸ“Š Running prisma db push...' && npx prisma db push --accept-data-loss --schema=./prisma/schema.prisma && echo 'âœ… Database ready!' && echo 'ðŸš€ Starting server...' && node dist/index.js"

[variables]
PRISMA_CLI_BINARY_TARGETS = "debian-openssl-3.0.x"

